<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> fastlaneè‡ªåŠ¨åŒ–æ‰“åŒ…éƒ¨ç½² Â· RecherJ's blog</title><meta name="description" content="fastlaneè‡ªåŠ¨åŒ–æ‰“åŒ…éƒ¨ç½² - RecherJ"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://recherj.github.io/atom.xml" title="RecherJ's blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://weibo.com/u/2698628733" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/RecherJ" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">fastlaneè‡ªåŠ¨åŒ–æ‰“åŒ…éƒ¨ç½²</h1><div class="post-info">Jun 13, 2018</div><div class="post-content"><p>æˆ‘ä»¬çš„ç»´è¯­ç”µå•†é¡¹ç›®æ˜¯ swift å’Œ OC æ··ç¼–ï¼Œæ‰€ä»¥æ¯æ¬¡æ‰‹åŠ¨æ‰“åŒ…å‘å¸ƒæµ‹è¯•ç‰ˆæ—¶å·¨æ…¢ï¼Œæœ€è¿‘åˆšå¥½æŠŠé¡¹ç›®é‡Œçš„éƒ¨åˆ†ç½‘ç»œåº“ä»åŸæ¥çš„OCç‰ˆæ¢åˆ°äº†swiftç‰ˆï¼Œæ­£åœ¨æ…¢æ…¢çš„å» Objective-C åŒ–ã€‚</p>
<p>ä¹…é—» fastlane æ˜¯è‡ªåŠ¨åŒ–éƒ¨ç½²åˆ©å™¨ï¼Œä»Šå¤©å°±ç€å®çœ‹äº†ä¸€ä¸‹æ•™ç¨‹ã€‚ç®€å•æŠŠæˆ‘è¸©è¿‡çš„å‘è®°å½•ä¸‹ã€‚</p>
<a id="more"></a>
<h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gem install fastlane -n /usr/<span class="built_in">local</span>/bin</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œç½‘ä¸Šå¤§éƒ¨åˆ†çš„æ•™ç¨‹æ˜¯è¯´ <code>sudo gem install fastlane</code> ä½†è‡³å°‘æˆ‘åœ¨ macOS High Sierra ä¸Šæ˜¯ä¸æˆåŠŸçš„ï¼Œä¼šæŠ¥æƒé™é—®é¢˜</p>
<blockquote>
<p>ERROR:  While executing gem â€¦ (Gem::FilePermissionError)<br>You donâ€™t have write permissions for the /usr/bin</p>
</blockquote>
<p>å‚è€ƒé“¾æ¥<a href="https://stackoverflow.com/questions/14607193/installing-gem-or-updating-rubygems-fails-with-permissions-error" target="_blank" rel="noopener">Installing gem or updating RubyGems fails with permissions error</a>ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘é€‰é€‰æ‹©äº†æŒ‡å®šç›®å½•å®‰è£…ã€‚</p>
<p>ç„¶åè¿›å…¥é¡¹ç›®å·¥ç¨‹ä¸­æ‰§è¡Œ <code>fastlane init</code> å®ƒä¼šè¯¢é—®ä¸€ä¸‹é…ç½®é€‰é¡¹ï¼Œå…ˆåä¾æ¬¡è¾“å…¥ AppID, AppleID ã€å¯†ç ã€iTunes Connect Team ç­‰å®ŒæˆåŸºç¡€é…ç½®åï¼Œä¼šé»˜è®¤æ‰§è¡Œ <code>$ bundle update</code>ï¼Œè¿™é‡Œæˆ‘ç­‰äº†å·®ä¸å¤šåŠå°æ—¶ï¼Œæ²¡ä»»ä½•ååº”ğŸ˜‚ ã€‚ç»ˆæ­¢åé‡æ–°æ‰‹åŠ¨æ‰§è¡Œäº†ä¸‹ <code>$ bundle update</code> è¯´æ²¡æœ‰æƒé™ï¼Œæœæ–­sudo åå¾ˆå¿«å°±å®‰è£…å¥½äº†ã€‚</p>
<p>æµ‹è¯•ç‰ˆéœ€è¦ä¸Šä¼ åˆ° fir.im æ‰€ä»¥è¿˜éœ€å®‰è£…ä¸¤ä¸ªéœ€è¦çš„æ’ä»¶ <code>fastlane add_plugin versioning</code>ã€<code>fastlane add_plugin firim</code> ï¼Œfirimè¿™ä¸ªæ’ä»¶å®‰è£…ä¹‹å‰æœ‰ä¾èµ– firim </p>
<p><img src="https://ws1.sinaimg.cn/large/006tNc79ly1fs9z63xaogj319m0astax.jpg" alt=""></p>
<p>æ‰€ä»¥åŒç†ä¹Ÿè¦æŒ‡å®šç›®å½•å®‰è£…</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo gem install -n /usr/<span class="built_in">local</span>/bin firim -v <span class="string">'0.2.1'</span> --<span class="built_in">source</span> <span class="string">'https://rubygems.org'</span></span><br></pre></td></tr></table></figure>
<p>å†å®‰è£… firim æ’ä»¶å°±æ­£å¸¸äº†ã€‚</p>
<h3 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p>ç¼–è¾‘ Fastfile</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">lane <span class="symbol">:to_firim</span> <span class="keyword">do</span></span><br><span class="line">  <span class="comment"># å¦‚æœä½ ç”¨ pod install</span></span><br><span class="line">  cocoapods</span><br><span class="line">  <span class="comment"># å¦‚æœä½ æ²¡æœ‰ç”³è¯·adhocè¯ä¹¦ï¼Œsighä¼šè‡ªåŠ¨å¸®ä½ ç”³è¯·ï¼Œå¹¶ä¸”æ·»åŠ åˆ°Xcodeé‡Œ</span></span><br><span class="line">  <span class="comment">#sigh(adhoc: true)</span></span><br><span class="line">  <span class="comment"># ä»¥ä¸‹ä¸¤ä¸ªactionæ¥è‡ªfastlane-plugin-versioningï¼Œ</span></span><br><span class="line">  <span class="comment"># ç¬¬ä¸€ä¸ªé€’å¢ Buildï¼Œç¬¬äºŒä¸ªè®¾å®šVersionã€‚</span></span><br><span class="line">  <span class="comment"># å¦‚æœä½ æœ‰å¤šä¸ªtargetï¼Œå°±å¿…é¡»æŒ‡å®štargetçš„å€¼ï¼Œå¦åˆ™å®ƒä¼šç›´æ¥æ‰¾æ‰¾åˆ°çš„ç¬¬ä¸€ä¸ªplistä¿®æ”¹</span></span><br><span class="line">  <span class="comment"># åœ¨è¿™é‡Œæˆ‘å»ºè®®æ¯ä¸€ä¸ªæ‰“çš„åŒ…çš„Buildéƒ½è¦ä¸ä¸€æ ·ï¼Œè¿™æ ·crashäº†æ‹¿åˆ°æ—¥å¿—ï¼Œå¯ä»¥å¯¹åº”åˆ°ipaä¸Š</span></span><br><span class="line">  increment_build_number_in_plist(<span class="symbol">target:</span> <span class="string">"XXXXX"</span>)</span><br><span class="line">  increment_version_number_in_plist(</span><br><span class="line">    <span class="symbol">target:</span> <span class="string">"XXXXX"</span>,</span><br><span class="line">    <span class="symbol">version_number:</span> <span class="string">'4.2.0'</span></span><br><span class="line">    )</span><br><span class="line">  <span class="comment"># gymç”¨æ¥ç¼–è¯‘ipa</span></span><br><span class="line">  gym(</span><br><span class="line">    <span class="symbol">output_directory:</span> <span class="string">'./firim'</span>,</span><br><span class="line">    <span class="symbol">export_options:</span> &#123;</span><br><span class="line">      <span class="symbol">method:</span> <span class="string">"ad-hoc"</span>, <span class="comment"># æŒ‡å®šæ‰“åŒ…æ–¹å¼</span></span><br><span class="line">      <span class="symbol">teamID:</span> <span class="string">"XXXXX"</span>,</span><br><span class="line">      <span class="symbol">thinning:</span> <span class="string">"&lt;none&gt;"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="symbol">scheme:</span> <span class="string">"XXXXX"</span></span><br><span class="line">    )</span><br><span class="line">  <span class="comment"># ä¸Šä¼ ipaåˆ°fir.imæœåŠ¡å™¨ï¼Œåœ¨fir.imè·å–firim_api_token</span></span><br><span class="line">  firim(<span class="symbol">firim_api_token:</span> <span class="string">"XXXXXXXXXXXXXXXXXXXX"</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>å°† target ã€ç‰ˆæœ¬å·ã€firim_tokenã€TeamIDç­‰ä¿¡æ¯é…ç½®å¥½åå°±å¯ä»¥ run <code>fastlane to_firim</code> ä¸Šä¼ åˆ° fir.im äº†ã€‚</p>
<h3 id="æ‰“åŒ…"><a href="#æ‰“åŒ…" class="headerlink" title="æ‰“åŒ…"></a>æ‰“åŒ…</h3><p>ç¬¬ä¸€æ¬¡æ‰§è¡Œåˆ° cocoapods æ—¶æŠ¥é”™äº†ï¼ŒæŸ¥äº†ä¸‹éœ€è¦åœ¨ Pluginfile æ–‡ä»¶ä¸­åŠ ä¸Š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem <span class="string">'cocoapods'</span></span><br></pre></td></tr></table></figure>
<p>ç„¶ååœ¨æ‰§è¡Œï¼Œå‘ç°ä¸Šä¼ firim æ—¶æŠ¥é”™ï¼Œä¸€æŸ¥å‘ç°æ²¡æœ‰è®¾ç½®tokenï¼Œå»fir.imä¸Šç”Ÿæˆäº†api_tokenåå¡«å†™ä¸Šåå†æ‰§è¡Œç»ˆäºæˆåŠŸäº†ã€‚</p>
<p><img src="https://ws4.sinaimg.cn/large/006tNc79ly1fs9zkgxyrxj319c0ho0vn.jpg" alt=""></p>
<p>ä¸Šfir.im æ£€æŸ¥ä¸‹ï¼Œæœ‰çš„ã€‚perfectï¼</p>
<p>è‡³æ­¤å°±åˆæ­¥å®Œæˆæœ€åŸºæœ¬çš„æµ‹è¯•ç‰ˆä¸Šä¼ çš„é…ç½®ï¼Œåç»­è¿˜éœ€è¦å†ç ”ç©¶ä¸‹å»é™¤ä¸€äº›ä¸å¿…è¦çš„logå’Œè­¦å‘Šï¼Œå› ä¸ºç›®å‰åœ¨æ‰“åŒ…æ—¶æ§åˆ¶å°ä¼šå°†æ‰€æœ‰çš„è­¦å‘Šä¹Ÿè¾“å‡ºã€‚</p>
<h3 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h3><ul>
<li><a href="https://blog.csdn.net/kmyhy/article/details/52441681" target="_blank" rel="noopener">fastlane æ•™ç¨‹: å…¥é—¨</a></li>
<li><a href="https://www.jianshu.com/p/c38157e5d6c1" target="_blank" rel="noopener">Fastlaneå®‰è£…æŒ‡å—</a></li>
<li><a href="https://docs.fastlane.tools" target="_blank" rel="noopener">fastlane docs</a></li>
<li><a href="https://www.jianshu.com/p/2918cf082b9d" target="_blank" rel="noopener">fastlane è‡ªåŠ¨æ‰“åŒ…åˆ° fir.im çš„è¸©å‘ä¹‹è·¯</a></li>
<li><a href="https://github.com/fastlane/fastlane/issues/6073" target="_blank" rel="noopener">iâ€™m requred to install cocoa pods,but i have installed. ! </a></li>
</ul>
</div></article></div></main><footer><div class="paginator"><a href="/2018/06/05/KingfisheråŠ è½½gifé—®é¢˜/" class="next">NEXT</a></div><div class="copyright"><p>Â© 2016 - 2018 <a href="https://recherj.github.io">RecherJ</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>